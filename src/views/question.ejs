<!DOCTYPE html>
<html lang="pt-br">
  <%- include('./components/head'); %>
  <body
    data-prismjs-copy="Copiar"
    data-prismjs-copy-error="Ops, tente CTRL+C"
    data-prismjs-copy-success="Copiado!"
    class="line-numbers"
  >
    <%- include('./components/navbar'); %>

    <main class="container gap-top">
      <section class="card text-white bg-dark">
        <div class="card-header">
          <h3><%=question.title%></h3>
        </div>
        <div class="card-body"><p><%-question.description%></p></div>
        <div
          class="card-footer d-flex justify-content-end justify-content-lg-between align-items-center"
        >
          <small class="text-muted d-none d-lg-block">
            Adicionada em <%= new
            Intl.DateTimeFormat().format(question.createdAt)%> | Atualizada em
            <%= new Intl.DateTimeFormat().format(question.updateAt)%>
          </small>
          <div class="card-buttons">
            <form
              action="/question/<%=question.id%>?_method=DELETE"
              method="POST"
            >
              <button class="btn btn-danger" type="submit">
                <i class="fa-solid fa-trash"></i>
              </button>

              <a href="#" class="btn btn-primary disabled">
                <i class="fa-solid fa-thumbs-up"></i>
              </a>
            </form>
          </div>
        </div>
      </section>
      <section id="answer" class="card text-white bg-dark gap-top">
        <form
          action="/answer/<%=question.id%>"
          method="POST"
          name="answer"
          onSubmit="return validate();"
        >
          <div class="card-header">
            <h3 class="card-title">Adicionar uma Resposta</h3>
          </div>
          <div class="card-body">
            <div id="liveAlert"></div>
            <textarea
              minlength="20"
              name="content"
              id="content"
              cols="30"
              rows="3"
              class="form-control"
              placeholder="Escreva uma Resposta"
            ></textarea>
          </div>
          <div class="card-footer d-flex justify-content-end">
            <button type="submit" class="btn btn-light">
              <i class="fa-solid fa-pencil"></i> Responder
            </button>
          </div>
        </form>
      </section>
      <section class="card bg-dark gap-top">
        <div class="card-header text-white bg-dark">
          <h3 class="card-title">Respostas</h3>
        </div>
        <div class="card-body p-4">
          <div class="card">
            <div class="card-body">
              <% question.answers.forEach((answer)=>{ %>
              <p class="card-text"><%-answer.content%></p>
              <small class="d-flex justify-content-end gap-bottom">
                Adicionada em <%= new
                Intl.DateTimeFormat().format(answer.createdAt)%> | Atualizada em
                <%= new Intl.DateTimeFormat().format(answer.updateAt)%>
              </small>
              <hr />
              <% })%>
            </div>
          </div>
        </div>
      </section>
    </main>
    <%- include('./components/footer-scripts.ejs'); %> <%-
    include('./components/tinymce-config.ejs'); %> <%-
    include('./components/show-alert.ejs'); %>
    <script language="JavaScript">
      let minimum = 3;
      function validate() {
        if (document.answer.content.value.length < minimum) {
          showAlert(
            `Sua Resposta deve ter mais que ${minimum} caracteres`,
            "danger"
          );
          return false;
        }
        return true;
      }
    </script>
  </body>
</html>
